## 문제 상황

잘못된 타임존 코드로 해외유저가 점검시간에 투자를 하지 못하는 현상

## 원인

- 타임존에 대한 부족한 이해도로 발생한 문제
- 점검시간을 검사하는 코드에서 `new Date()`를 사용해서 발생하는 문제

## 이해

1. 국내 P2P 중앙관리기록관의 점검시간은 국내기준 23:30 ~ 00:30 이다.
2. 해외에서 접속하든, 국내에서 접속하든 어디에서 접속하든지 국내기준 시간대에 점검이 이루어진다.
3. 아래와 같이 `new Date()`를 사용하면 안된다. `now.getHours()`와 `now.getMinutes()`는 코드가 실행되는 클라이언트 시간대의 "시"와 "분"을 반환한다.

```js
function is점검시간() {
  const now = new Date();
  if (now.getHours() > 23 && now.getMinutes() > 30) {
  }
}
```

4. 예를 들어보자. 한국과 미국의 시차는 13시간으로 미국이 13시간 빠르다. 만약 한국이 지금 오후 22시 30분이라면 미국은 오전 9시 30분이다.
5. 그러니까 미국에 사는 유저가 9시 30분에 투자를 하려고해도 한국은 현재 22시 30분이다. 중앙관기기록관의 점검시간이기 떄문에 계속 투자가 실패하는 것이다.

## 해결

해외 유저도 국내시간을 기준으로 점검시간을 판단하도록 해야한다. `new Date()`를 사용해서 점검시간을 판단하는 것이 아니라, 타임존을 한국에 고정해서 점검시간을 판단해야한다.

- date-fns-tz 라이브러리를 활용하여 타임존을 국내로 고정했다. 국내점검시간을 확인하고 점김 UI를 볼 수 있도록 해결

```ts
import { toZonedTime } from "date-fns-tz";

// 한국 타임존으로 고정된 date 객체를 다룸
const date = toZonedTime(new Date(), "Asia/seoul");
```
